(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[48,974],{8963:(e,t,n)=>{Promise.resolve().then(n.bind(n,9119))},9119:(e,t,n)=>{"use strict";n.d(t,{ContentView:()=>S});var r=n(5155),a=n(2115);let l=["⋮","⋰","⋯","⋱"];function u(){var e;let[t,n]=(0,a.useState)(-1);return(0,a.useEffect)(()=>{let e=setInterval(()=>{n(e=>(e+1)%l.length)},200);return()=>clearInterval(e)},[]),(0,r.jsx)("pre",{children:null!==(e=l[t])&&void 0!==e?e:""})}var c=n(4065),i=n(4096),s=n(6266),o=n(3169),h=n(3893),d=new WeakMap,v=new WeakMap,m=new WeakMap,f=new WeakSet;class g{addCommand(e){let t=this.debug();(0,s._)(this,m,(0,c._)(this,d).length-1),(0,c._)(this,d)[(0,c._)(this,m)]=e,(0,c._)(this,d).push(""),(0,s._)(this,m,(0,c._)(this,d).length-1),(0,s._)(this,v,(0,c._)(this,d).slice()),console.log("Adding command: '".concat(e,"'\nBefore: ").concat(t,"\nAfter: ").concat(this.debug()))}getPreviousCommand(e){return(0,o._)(this,f,p).call(this,(0,c._)(this,m)-1,e)}getNextCommand(e){return(0,o._)(this,f,p).call(this,(0,c._)(this,m)+1,e)}debug(){return"CommandHistory: ".concat(JSON.stringify((0,c._)(this,d)),", CurrentIndex: ").concat((0,c._)(this,m),", TemporaryCommands: ").concat(JSON.stringify((0,c._)(this,v)))}constructor(){(0,h._)(this,f),(0,i._)(this,d,{writable:!0,value:void 0}),(0,i._)(this,v,{writable:!0,value:void 0}),(0,i._)(this,m,{writable:!0,value:void 0}),(0,s._)(this,d,[""]),(0,s._)(this,v,[""]),(0,s._)(this,m,0)}}function p(e,t){let n=this.debug();return e>=0&&e<(0,c._)(this,d).length?((0,c._)(this,v)[(0,c._)(this,m)]=t,(0,s._)(this,m,e),console.log("(A) Switching to command at index: ".concat(e,", '").concat(t,"'\nBefore: ").concat(n,"\nAfter: ").concat(this.debug())),(0,c._)(this,v)[e]):(console.log("(B) Switching to command at index: ".concat(e,", '").concat(t,"'\nBefore: ").concat(n,"\nAfter: ").concat(this.debug())),t)}var _=n(2812);function C(e){let t=_.z.getInstance().resolve(e),[,n]=(0,a.useReducer)(e=>e+1,0);return(0,a.useEffect)(()=>{if("function"==typeof t.subscribe)return t.subscribe(n)},[t]),t}function b(e){setTimeout(()=>{e.setSelectionRange(e.value.length,e.value.length)},0)}var x=n(9114),k=n(4710);function w(e){let{onCommand:t}=e,[n,l]=(0,a.useState)(!1),[c,i]=(0,a.useState)(""),s=(0,a.useRef)(null),o=function(e){let t=C(g),n=(0,a.useCallback)(()=>{var n;if(!e.current)return;let r=null===(n=e.current)||void 0===n?void 0:n.value;t.addCommand(r)},[e,t]),r=(0,a.useCallback)(()=>{var n;if(!e.current)return;let r=null===(n=e.current)||void 0===n?void 0:n.value,a=t.getPreviousCommand(r);a!==r&&(e.current.value=a,b(e.current))},[e,t]),l=(0,a.useCallback)(()=>{var n;if(!e.current)return;let r=null===(n=e.current)||void 0===n?void 0:n.value,a=t.getNextCommand(r);a!==r&&(e.current.value=a,b(e.current))},[e,t]);return(0,a.useMemo)(()=>({addCommand:n,getPreviousCommand:r,getNextCommand:l}),[n,r,l])}(s),h=function(e){let[t,n]=(0,a.useState)(""),r=C(x.$),l=(0,a.useRef)(0),u=(0,a.useCallback)(()=>{var t,a,u,c;if(!e.current||(u=e.current).selectionStart!==u.value.length)return;let i=e.current.value,s=null!==(t=i.split(" ").pop())&&void 0!==t?t:"",o=r.getDirectory(),h=null!==(a=null==o?void 0:o.complete(s))&&void 0!==a?a:"",d=h.length>s.length;if(d&&(e.current.value="".concat(i).concat(h.slice(s.length)),c=e.current,setTimeout(()=>{c.setSelectionRange(c.value.length,c.value.length)},0)),!d){let e=Date.now();if(l.current+500>e){let e=null==o?void 0:o.getCompletions(s);e?n(e.join(", ")):n("No completions")}l.current=e}},[e,r]),c=(0,a.useCallback)(()=>{n("")},[]);return(0,a.useMemo)(()=>({hint:t,clearHint:c,completeCommand:u}),[t,c,u])}(s),d=C(x.$).getPath(),v=C(k.$).isRunning(),m=(0,a.useCallback)(e=>{if(h.clearHint(),"Enter"===e.key){let n=e.currentTarget.value;""!==n.trim()&&(o.addCommand(),t(n)),e.currentTarget.value="",l(!0)}if("ArrowUp"===e.key&&o.getPreviousCommand(),"ArrowDown"===e.key&&o.getNextCommand(),"Tab"!==e.key||(e.preventDefault(),h.completeCommand(),n||e.currentTarget.value||(e.currentTarget.value="help")),e.ctrlKey&&"u"===e.key){e.preventDefault();let t=e.currentTarget.value;t&&i(t),e.currentTarget.value=""}e.ctrlKey&&"y"===e.key&&(e.preventDefault(),e.currentTarget.value+=c)},[t,o,h,n,c]);return((0,a.useEffect)(()=>{v&&s.current&&s.current.focus({preventScroll:!0})},[v]),v)?(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("div",{className:"flex",children:[d,(0,r.jsx)("span",{className:"prompt whitespace-pre",children:"$ "}),(0,r.jsx)("input",{ref:s,"data-ref":"prompt",type:"text",placeholder:n?"":"help",className:"command text-light-gray border-none outline-none flex-1",onKeyDown:m})]}),h.hint&&(0,r.jsx)("div",{className:"hint",children:h.hint})]}):(0,r.jsx)(u,{})}var y=n(3632),N=n(4586);function S(e){let{initialCommands:t,initialPath:n}=e,l=C(y.f),u=(0,N.l)(),c=(0,a.useRef)(null),i=(0,a.useCallback)(e=>u([k.$],async t=>{await t.executeCommand(e),setTimeout(()=>{c.current&&c.current.scrollIntoView({behavior:"smooth"})},0)}),[u]);return(0,a.useEffect)(()=>{u([x.$,k.$],async(e,r)=>{for(let a of(l.clear(),n&&e.changePath(n),t))await r.executeCommand(a)})},[u,l,t,n]),(0,r.jsxs)(r.Fragment,{children:[l.getContent().map((e,t)=>(0,r.jsx)("div",{className:"output",children:e},t)),(0,r.jsx)(w,{onCommand:i}),(0,r.jsx)("div",{ref:c})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[458,228,992,441,684,358],()=>t(8963)),_N_E=e.O()}]);